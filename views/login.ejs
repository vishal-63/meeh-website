<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
    />
    <meta
      name="Content-Security-Policy-Report-Only"
      content="script-src https://accounts.google.com/gsi/client; frame-src https://accounts.google.com/gsi/; connect-src https://accounts.google.com/gsi/;"
    />
    <meta
      name="google-signin-client_id"
      content="649922066604-90k8n6au857isf9oo7og9nhp9f0nhb8a.apps.googleusercontent.com"
    />

    <title>Meehh - Login</title>

    <!-- Fav Icon -->
    <link rel="icon" href="/assets/images/favicon.ico" type="image/x-icon" />

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Josefin+Sans:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,400;0,500;0,600;0,700;0,800;0,900;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
      rel="stylesheet"
    />

    <!-- Stylesheets -->
    <link href="/assets/css/font-awesome-all.css" rel="stylesheet" />
    <link href="/assets/css/flaticon.css" rel="stylesheet" />
    <link href="/assets/css/owl.css" rel="stylesheet" />
    <link href="/assets/css/bootstrap.css" rel="stylesheet" />
    <link href="/assets/css/jquery.fancybox.min.css" rel="stylesheet" />
    <link href="/assets/css/animate.css" rel="stylesheet" />
    <link href="/assets/css/jquery-ui.css" rel="stylesheet" />
    <link href="/assets/css/jquery.bootstrap-touchspin.css" rel="stylesheet" />
    <link href="/assets/css/nice-select.css" rel="stylesheet" />
    <link href="/assets/css/color.css" rel="stylesheet" />
    <link href="/assets/css/style.css" rel="stylesheet" />
    <link href="/assets/css/responsive.css" rel="stylesheet" />

    <script src="https://accounts.google.com/gsi/client" async defer></script>
  </head>

  <!-- page wrapper -->
  <body>
    <div class="boxed_wrapper">
          <!-- search-popup -->
          <div id="search-popup" class="search-popup">
              <div class="close-search"><i class="flaticon-close"></i></div>
              <div class="popup-inner">
                  <div class="overlay-layer"></div>
                  <div class="search-form">
                      <form method="GET" action="/products/search">
                          <div class="form-group">
                              <fieldset>
                                  <input type="search" class="form-control" name="q" value="" placeholder="Search Here" required >
                                  <input type="submit" value="Search Now!" class="theme-btn style-four">
                              </fieldset>
                          </div>
                      </form>
                      <h3>Popular Search Keywords</h3>
                      <ul class="recent-searches">
                          <li><a href="/products?category=bookmark">Bookmark</a></li>
                          <li><a href="/products?category=pop gripper">Pop Grippers</a></li>
                          <li><a href="/products/search?q=friends">Friends</a></li>
                          <li><a href="/products/search?q">Game of Thrones</a></li>
                          <li><a href="/products/search?q=blackpink">Blackpink</a></li>
                      </ul>
                  </div>
              </div>
          </div>
          <!-- search-popup end -->


          <!-- main header -->
          <header class="main-header">
              
              <div class="header-lower">
                  <div class="auto-container">
                      <div class="outer-box">
                          <figure class="logo-box"><a href="/"><img src="assets/images/header-logo.png" alt=""></a></figure>
                          <div class="menu-area">
                              <!--Mobile Navigation Toggler-->
                              <div class="mobile-nav-toggler">
                                  <i class="icon-bar"></i>
                                  <i class="icon-bar"></i>
                                  <i class="icon-bar"></i>
                              </div>
                              <nav class="main-menu navbar-expand-md navbar-light">
                                  <div class="collapse navbar-collapse show clearfix" id="navbarSupportedContent">
                                      <ul class="navigation clearfix">
                                          <li class="current">
                                            <a href="/">Home</a>
                                          </li>
                                          <li class="dropdown"><a href="/products">Shop<span>Hot</span></a>
                                              <ul>
                                              <li><a href="/products?category=bookmark">Bookmarks</a></li>
                                              <li><a href="/products?category=pop gripper">Pop Grippers</a></li>
                                              <li><a href="/products?category=tote bag">Tote Bags</a></li>
                                              <li><a href="/products?category=badge">Badges</a></li>
                                              <li><a href="/products?category=a5 dairy">Diaries</a></li>
                                              <li><a href="/products?category=mousepad">Mousepads</a></li>
                                            </ul>
                                          </li>
                                          <li><a href="/about">About</a></li>    
                                          <!-- <li><a href="/blogs">Blog</a></li>  -->
                                          <li><a href="/contact">Contact</a></li>               
                                      </ul>
                                  </div>
                              </nav>
                          </div>
                          <ul class="menu-right-content clearfix">
                              <li>
                                  <div class="search-btn">
                                      <button type="button" class="search-toggler"><i class="flaticon-search"></i></button>
                                  </div>
                              </li>
                              <li><a href="/wishlist"><i class="flaticon-like"></i></a></li>
                              <li class="dropdown"><a href=""><i class="flaticon-user"></i></a>
                                <ul>
                                  <% if(userLoggedIn) { %>
                                  <li><a href="/profile">Profile</a></li>
                                  <li><a href="/orders">Your orders</a></li>
                                  <li><a href="/logout">Logout</a></li>
                                  <% } else { %> 
                                  <li><a href="/login">Log In</a></li>
                                  <li><a href="/register">Sign Up</a></li>
                                  <% } %>
                              </ul></li>
                              <li class="shop-cart">
                                  <a href="/cart"><i class="flaticon-shopping-cart-1"></i><span><%=cartLength%></span></a>
                              </li>
                          </ul>
                      </div>
                  </div>
              </div>

              <!--sticky Header-->
              <div class="sticky-header">
                  <div class="auto-container">
                      <div class="outer-box clearfix">
                          <div class="logo-box pull-left">
                              <figure class="logo"><a href="/"><img src="assets/images/small-logo.png" alt=""></a></figure>
                          </div>
                          <div class="menu-area pull-right">
                              <nav class="main-menu clearfix">
                                  <!--Keep This Empty / Menu will come through Javascript-->
                              </nav>
                          </div>
                      </div>
                  </div>
              </div>
          </header>
          <!-- main-header end -->

          <!-- Mobile Menu  -->
          <div class="mobile-menu">
              <div class="menu-backdrop"></div>
              <div class="close-btn"><i class="fas fa-times"></i></div>
              <nav class="menu-box">
                  <div class="nav-logo"><a href="/"><img src="assets/images/small-logo.png" alt="" title=""></a></div>
                  <div class="menu-outer"><!--Here Menu Will Come Automatically Via Javascript / Same Menu as in Header--></div>
                  <div class="contact-info">
                      <h4>Contact Info</h4>
                      <ul>
                          <!-- <li>Chicago 12, Melborne City, USA</li> -->
                          <li><a href="tel:+91-9773034478">+91 97730 34478</a></li>
                          <li><a href="mailto:meehh.com@gmail.com">meehh.com@gmail.com</a></li>
                      </ul>
                  </div>
                  <div class="social-links">
                      <ul class="clearfix">
                          <li><a href="/"><span class="fab fa-twitter"></span></a></li>
                          <li><a href="/"><span class="fab fa-facebook-square"></span></a></li>
                          <li><a href="/"><span class="fab fa-pinterest-p"></span></a></li>
                          <li><a href="/"><span class="fab fa-instagram"></span></a></li>
                          <li><a href="/"><span class="fab fa-youtube"></span></a></li>
                      </ul>
                  </div>
              </nav>
          </div><!-- End Mobile Menu -->

    <!-- myaccount-section -->
    <section class="myaccount-section">
      <div class="auto-container d-flex">
        <div class="d-none d-lg-block col-5 p-5 my-auto">
          <img src="/assets/images/icons/login.svg" alt="">
        </div>
        <div class="col-lg-6 offset-lg-1">
          <div class="inner-column">
            <div class="inner-box login-inner p-3 py-4 p-sm-4 p-lg-5">
              <div class="upper-inner">
                <h3>Log in</h3>
                <p>Log in to snatch our product!</p>
              </div>
              <div class="hide login-error" role="alert"></div>
              <form class="default-form login-form">
                <div class="form-group">
                  <label>Email address</label>
                  <input type="email" name="email" required />
                  <div class="email-error"></div>
                </div>
                <div class="form-group">
                  <label>Password</label>
                  <input type="password" name="password" required />
                  <div class="password-error"></div>
                </div>
                <!-- <div class="form-group">
                  <a href="#" class="recover-password" data-toggle="modal" data-target="#recoverPasswordModal">Forgot password?</a>
                </div> -->
                <div class="form-group col-12 col-sm-4 col-lg-12 pl-0">
                  <button class="theme-btn-two">
                    Log In<i class="flaticon-right-1"></i>
                  </button>
                </div>
              </form>
              <div class="lower-inner centred">
                <span>or</span>
                <!-- <ul class="social-links clearfix">
                  <li>
                    <div id="google-login-btn"></div>
                  </li>
                </ul> -->
                <p>
                  Don't Have an Account?
                  <a href="/register" class="text-primary">Sign up Now</a>
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <!-- myaccount-section end -->

    <!-- Forgot password modal -->
    <div class="modal fade" id="recoverPasswordModal" tabindex="-1" role="dialog" aria-labelledby="Recover Password Modal" aria-hidden="true">
      <div class="modal-dialog  modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Recover Password</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <div class="modal-text">Enter your registered email address.</div>
            <span class="text-muted">A link to reset your password will be sent to this email address</span>
              <div class="form-group">
                <label for="email" class="col-form-label">Email:</label>
                <input type="email" class="form-control" id="forgot-password-email">
                <span class="text-dangered error"></span>
              </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="theme-btn-two" onclick="forgotPassword()">Submit</button>
          </div>
        </div>
      </div>
    </div>

    <script>
      // send token recieved from google after user sign up to server to create user
      // async function handleCredentialResponse(response) {
      //   const token = response.credential;
      //   console.log(token);
      //   const res = await fetch("/auth/google/sign-up", {
      //     method: "POST",
      //     body: JSON.stringify({ token: token }),
      //     headers: {
      //       "Content-Type": "application/json",
      //     },
      //   });
      //   if (res.ok) {
      //     location.assign("/products");
      //   } else {
      //     const data = await res.json();
      //     console.log(data);
      //   }
      // }

      // inititalize google login button
      // window.onload = function () {
      //   google.accounts.id.initialize({
      //     client_id:
      //       "649922066604-90k8n6au857isf9oo7og9nhp9f0nhb8a.apps.googleusercontent.com",
      //     callback: handleCredentialResponse,
      //   });
      //   google.accounts.id.renderButton(
      //     document.getElementById("google-login-btn"),
      //     { theme: "filled_blue", size: "large", text: "signin_with" } // customization attributes
      //   );
      //   google.accounts.id.prompt(); // also display the One Tap dialog
      // };

      // handle user login
      const loginForm = document.querySelector("form.login-form");
      const loginError = document.querySelector("div.login-error");

      loginForm.addEventListener("submit", async (e) => {
        e.preventDefault();

        // clear the errors
        loginError.textContent = "";

        // get the input values
        const email = loginForm.email.value;
        const password = loginForm.password.value;

        try {
          const res = await fetch("/login", {
            method: "POST",
            body: JSON.stringify({ email, password }),
            headers: {
              "Content-Type": "application/json",
            },
          });
          console.log(res);
          const data = await res.json();
          console.log(data);
          if (res.ok) {
            loginError.textContent = data.message;
            loginError.classList.remove("hide");
            loginError.classList.add("alert");
            loginError.classList.add("alert-success");
            setTimeout(() => location.assign("/products"), 1000);
          } else {
            loginError.textContent = data.error;
            loginError.classList.remove("hide");
            loginError.classList.add("alert");
            loginError.classList.add("alert-danger");
            console.log(data.error);
          }
        } catch (err) {
          console.log(err);
        }
      });
    

      const forgotPasswordForm = document.querySelector("form.for-password-form")

      async function forgotPassword (emailInput) {
        const email = document.querySelector("input#forgot-password-email").value
        const res = await fetch("/profile/forgotPassword", {
          method: "POST",
          body: JSON.stringify({email}),
          headers: {
            "Content-Type": "application/json"
          }
        })
        console.log(await res.json);
      }
    </script>

    <!-- jequery plugins -->
    <script src="/assets/js/jquery.js"></script>
    <script src="/assets/js/popper.min.js"></script>
    <script src="/assets/js/bootstrap.min.js"></script>
    <script src="/assets/js/owl.js"></script>
    <script src="/assets/js/wow.js"></script>
    <script src="/assets/js/validation.js"></script>
    <script src="/assets/js/jquery.fancybox.js"></script>
    <script src="/assets/js/TweenMax.min.js"></script>
    <script src="/assets/js/appear.js"></script>
    <script src="/assets/js/scrollbar.js"></script>
    <script src="/assets/js/jquery.nice-select.min.js"></script>
    <script src="/assets/js/isotope.js"></script>
    <script src="/assets/js/jquery-ui.js"></script>
    <script src="/assets/js/jquery.bootstrap-touchspin.js"></script>

    <!-- main-js -->
    <script src="/assets/js/script.js"></script>
  </body>
  <!-- End of .page_wrapper -->
</html>
